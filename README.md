
# Управление списком позиций

#### Запрос для создания позиции.  В теле запроса отправлять данные в формате JSON, пример:

```
[POST] /api/v1/position/create
```
>Доступен только администратору

```typescript
  {
    "name":"TEST", // Наименование товара
    "article":"T123", // Необязательное поле
    "quantity": 10, //Колличество товара, значение по умолчанию 1
    "cost": 100, // Цена закупки, по умолчанию 1
    "cost_of_sale": 120, // Цена продажи, по умолчанию 1
    "alias_id": "5d41ca473d9287046ddee862" // Идентификатор для генерции QR Code, уникальный, должен содержать 24 симовола, из-за особенностей front-end
  }
```

#### Запрос для получения списка позиций, принимает GET параметры:

```
[GET] /api/v1/position/all?offset=0&limit=30
```

>offset - Количество пропускаемых записей\
>limit - Лимит записей для вывода\
>search - Артикул или наименования товара, параметр для поиска\
>qrcode - alias_id товара, для поиска по qrcode

>По умолчанию ?offset=0&limit=1000.

```typescript
  
  {
    "count": 2,
    "results": [
      {
        "id":1,
        "name":"TEST",
        "article":"T123", 
        "quantity": 10,
        "cost": 100, 
        "cost_of_sale": 120,
        "alias_id": "5d41ca473d9287046ddee862" 
      },
      {
        "id":2,
        "name":"TEST 2",
        "article":"T1234", 
        "quantity": 10,
        "cost": 100, 
        "cost_of_sale": 120,
        "alias_id": "5d41ca473d9287046ddee863" 
      }
    ]
  }
```

#### Запрос для редактирования позиции.

```
[PATCH] /api/v1/position/detail/<id позиции>
```
>Доступен только администратору

>Можно изменить как все поля, так и по отдельности

```typescript
  {
    "name":"TEST",
    "article":"T123", 
    "quantity": 10,
    "cost": 100, 
    "cost_of_sale": 120,
    "alias_id": "5d41ca473d9287046ddee862" 
  }
```

#### Запрос для удаления позиции.

```
[DELETE] /api/v1/position/detail/<id позиции>
```
>Доступен только администратору

#### Запрос для получения закупочной стоимости всех товаров

```
[GET] /api/v1/position/total
```
>Доступен только администратору

```typescript
  {
    "count": 3000, // Количество товаров
    "result": 1000000 // Закупочная стоимость всех товаров
  }
```

# Управление списком рабочих

#### Запрос для добавления рабочего.  В теле запроса отправлять данные в формате JSON, пример:

```
[POST] /api/v1/companion/create
```
>Доступен только администратору

```typescript
  {
    "full_name":"Иванов Иван Иванович", // ФИО сотрудника
    "phone":"+7(123)123-12-12", // Телефон сотрудника
    "percent": 25 // Процент сотрудника от выполненых работ
  }
```

#### Запрос для получения списка сотрудников.

```
[GET] /api/v1/companion/all
```
>Доступен только администратору

```typescript
  [
    {
    "id": 1
    "full_name":"Иванов Иван Иванович",
    "phone":"+7(123)123-12-12",
    "percent": 25
    },
    {
    "id": 2
    "full_name":"Иванов Иван Иванович",
    "phone":"+7(123)123-12-12",
    "percent": 25
    }
  ]
```

#### Запрос для редактирования данных сотрудника.

```
[PATCH] /api/v1/companion/detail/<id сотрудника>
```
>Доступен только администратору

>Можно изменить как все поля, так и по отдельности

```typescript
  {
    "full_name":"Иванов Иван Иванович",
    "phone":"+7(123)123-12-12",
    "percent": 25
  }
```

#### Запрос для удаления сотрудника из списка.

```
[DELETE] /api/v1/companion/detail/<id позиции>
```
>Доступен только администратору


# Управление заказом

#### Запрос для добавления заказа.  В теле запроса отправлять данные в формате JSON, пример:

```
[POST] /api/v1/order/create
```
>Доступен только администратору

```typescript
  {
    "done": true, // Статус заказа, не обязательное поле, по умолчанию false
    "detail": { // Обязательный объект для передачи
      "full_name": "Иванов Иван Иванович", // ФИО заказчика, обязательное поле
      "phone": "+7(912)123-12-12", // Телефон заказчика, обязательное поле
      "address_delivery": "Moscow", // Адрес доставки, не обязательное поле, по умолчанию null
      "sale": 10 // Скидка на заказ в процентах, не обязательное поле, по умолчанию 0
    }, 
    "companion": { // Не обязательный объект для передачи 
      "companion": 1, // id сотрудника, обязательное поле
      "cost_of_work": 1000, // Стоимость работ, обязательное поле
      "done": true // Статус выполения работ, не обязательное поле, по умолчанию false
    },
    "positions": [ // Обязательный массив для передачи
      {
        "position": 1, // id позиции, обязательное поле
        "name": "Колесо", // Наименование позиции, обязательное поле
        "article": "123", // Артикул позиции, не обязательное поле
        "quantity": 10, // Колличество, обязательное поле
        "cost": 1000, // Цена закупки, обязательное поле
        "cost_of_sale": 1200, // Цена продажи, обязательное поле
        "companion": 1, // id сотрудника, не обязательное поле
        "companion_percent": 10 // процент сотруднику за подбор запчасти, не обязательное поле
      }
    ]
  }
```

#### Запрос для получения списка заказов, принимает GET параметры:

```
[GET] /api/v1/order/all?offset=0&limit=30
```
>Доступен только администратору

>offset - Количество пропускаемых записей\
>limit - Лимит записей для вывода\
>status - Статус заказа, может быть:\
>>pending - Заказ выполняется\
>>successed - Заказ выполнен

>phone - Сортировка по номеру телефона\
>order - Сортировка по номеру заказа

>По умолчанию ?status=pending&offset=0&limit=1000.

```typescript
  {
    "count": 2,
    "results": [
      {
        "id": 104,
        "detail": {
          "full_name": "pavel",
          "phone": "743",
          "address_delivery": null,
          "sale": 0
        },
        "companion": {
          "companion": {
            "id": 1,
            "full_name": "Pavel",
            "phone": "1",
            "percent": 25
          },
          "cost_of_work": 1000,
          "done": false
        },
        "positions": [
          {
            "id": 77,
            "name": "Наждачная бумага Р400",
            "article": "F 03E 003 DK9",
            "quantity": 73,
            "cost": 34,
            "cost_of_sale": null,
            "companion": 1,
            "companion_percent": 10,
            "position": {
              "id": 1,
              "name": "Наждачная бумага Р400",
              "article": "F 03E 003 DK9",
              "quantity": 128,
              "cost": 34,
              "cost_of_sale": 50,
              "alias_id": "5d41ca473d9287046ddee862"
            }
          }
        ],
        "done": false,
        "date_added": "2020-04-24T12:02:14.769165Z"
      },
      {
        "id": 105,
        "detail": {
          "full_name": "pavel",
          "phone": "743",
          "address_delivery": null,
          "sale": 0
        },
        "companion": null,
        "positions": [
          {
            "id": 78,
            "name": "Наждачная бумага Р400",
            "article": "F 03E 003 DK9",
            "quantity": 1,
            "cost": 34,
            "cost_of_sale": null,
            "companion": null,
            "companion_percent": 0,
            "position": {
              "id": 1,
              "name": "Наждачная бумага Р400",
              "article": "F 03E 003 DK9",
              "quantity": 128,
              "cost": 34,
              "cost_of_sale": 50,
              "alias_id": "5d41ca473d9287046ddee862"
            }
          }
        ],
        "done": false,
        "date_added": "2020-04-24T12:03:32.809202Z"
      }
    ]
  }
```

#### Запрос для редактирования данных о заказе.

```
[PATCH] /api/v1/order/detail/<id заказа>
```
>Доступен только администратору

>Можно изменить как все поля, так и по отдельности

```typescript
  {
    "detail": {
      "full_name": "pavel",
      "phone": "743",
      "address_delivery": null,
      "sale": 0
    },
    "companion": {
      "companion": 1,
      "cost_of_work": 1000
    },
    "done": true
  }
```

#### Запрос для удаления заказа из списка.

```
[DELETE] /api/v1/order/detail/<id заказа>
```
>Доступен только администратору


#### Запрос для добавления позиции к заказу.

```
[POST] /api/v1/order/position/added
```
>Доступен только администратору

```typescript
  {
    "order": 105 //id заказа, обязательное поле
    "name": "Наждачная бумага Р400", // Обязательное поле
    "article": "F 03E 003 DK9", // Обязательное поле
    "quantity": 1, // Обязательное поле
    "cost": 34, // Обязательное поле
    "cost_of_sale": null, // Обязательное поле
    "companion": null, // Не обязательное поле
    "companion_percent": 0, // Не обязательное поле
    "position": 1 // Обязательное поле
  }
```


#### Запрос для редактирования данных о позиции привязоной к заказу.

```
[PATCH] /api/v1/order/position/detail/<id позиции>
```
>Доступен только администратору

>Можно изменить как все поля, так и по отдельности

```typescript
  {
    "quantity": 10,
    "companion": 1,
    "companion_percent": 10
  }
```


#### Запрос для удаления позиции из заказа.

```
[DELETE] /api/v1/order/position/detail/<id позиции>
```
>Доступен только администратору
